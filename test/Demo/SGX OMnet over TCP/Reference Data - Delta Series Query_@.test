<?xml version="1.1" encoding="ASCII"?>
<TestUnit:TestContainerType xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:CertificationCommands="com.esprow.nozomi.testunit.commands.certification" xmlns:TestUnit="com.esprow.nozomi.testunit" formatVersion="2.1">
  <test comment="This certification test checks the submission of DQ124 to retrieve the information of all tradeable instrument series." loggingLevel="DEBUG" certificationUnit="true" dictionary="SGX_OMnet_REACH" implementsBridgeMode="true">
    <testCommand xsi:type="CertificationCommands:CreateMessageRelayCommand" targetSystemId="%CONFIGURATIONS.CERTIFICATION.SYSTEM%" targetHandlerId="%CONFIGURATIONS.CERTIFICATION.DESTINATION%" forwardSystemId="%CONFIGURATIONS.CERTIFICATION.BRIDGE.SYSTEM%" forwardHandlerId="%CONFIGURATIONS.CERTIFICATION.BRIDGE.DESTINATION%" filterShowOnly="true" validateMessages="true">
      <messageTypeFilters>TRANSACTION_ANSWER</messageTypeFilters>
      <messageTypeFilters>DQ124</messageTypeFilters>
      <messageTypeFilters>DA124</messageTypeFilters>
    </testCommand>
    <testCommand xsi:type="TestUnit:ClearMessageQueue" messageSenderProducer="//@test/@testCommand.0" incoming="true" outgoing="true"/>
    <testCommand xsi:type="TestUnit:GetInteractiveFeedbackCommand">
      <instructionMultiLanguage key="en" value="Please connect to below IP address and port for this test&#xD;&#xA;&#xD;&#xA;   IP Address: %CONFIGURATIONS.Application_Target_IP%&#xD;&#xA;   Port: %CONFIGURATIONS.Application_Target_Port%"/>
    </testCommand>
    <testCommand xsi:type="TestUnit:GroupCommand" name="Submit_DQ124">
      <testCommand xsi:type="TestUnit:ClearMessageQueue" messageSenderProducer="//@test/@testCommand.0" incoming="true" outgoing="true"/>
      <testCommand xsi:type="TestUnit:GetInteractiveFeedbackCommand">
        <instructionMultiLanguage key="en" value="Please submit a DQ124 to query all tradable instrument series in all markets.&#xD;&#xA;&#xD;&#xA;Note: As DQ124 is a segmented query, please wait for around 5 minutes to fully completed this test case"/>
      </testCommand>
      <testCommand xsi:type="TestUnit:WaitCommand" disabled="true" messageSenderProducer="//@test/@testCommand.0" messageCount="1" timeout="-1" searchFromLastMatch="true" searchFromLastMatchCombined="true" removeMatched="true">
        <testCommand xsi:type="TestUnit:CreateFieldValueCheckCommand" disabled="true" path="query_delta_t[].query_delta_t.transaction_type[].transaction_type_t.central_module_c" value="D" fieldType="Char"/>
        <testCommand xsi:type="TestUnit:CreateFieldValueCheckCommand" disabled="true" path="query_delta_t[].query_delta_t.transaction_type[].transaction_type_t.server_type_c" value="Q" fieldType="Char"/>
        <testCommand xsi:type="TestUnit:CreateFieldValueCheckCommand" disabled="true" path="query_delta_t[].query_delta_t.transaction_type[].transaction_type_t.transaction_number_n" value="124" fieldType="BigDecimal"/>
        <testCommand xsi:type="TestUnit:CreateFieldValueCheckCommand" disabled="true" path="query_delta_t[].query_delta_t.segment_number_n" value="1" fieldType="BigDecimal"/>
        <testCommand xsi:type="TestUnit:CreateFieldValueCheckCommand" disabled="true" path="query_delta_t[].query_delta_t.download_ref_number_q" value="0" checkType="SMALLER_OR_EQUAL" fieldType="Long"/>
        <testCommand xsi:type="TestUnit:CreateFieldValueCheckCommand" disabled="true" path="query_delta_t[].query_delta_t.series[].series_t.market_c" value="0 || %CONFIGURATIONS.Series_Market%" fieldType="BigDecimal"/>
        <messageType>DQ124</messageType>
      </testCommand>
      <testCommand xsi:type="TestUnit:WaitCommand" disabled="true" messageId="DA124" messageSenderProducer="//@test/@testCommand.0" messageCount="1" timeout="-1" searchFromLastMatch="true" searchFromLastMatchCombined="true" outgoingMessage="true" removeMatched="true">
        <testCommand xsi:type="TestUnit:CreateFieldValueCheckCommand" disabled="true" path="answer_segment_hdr_t[].answer_segment_hdr_t.transaction_type[].transaction_type_t.central_module_c" value="D" fieldType="Char"/>
        <testCommand xsi:type="TestUnit:CreateFieldValueCheckCommand" disabled="true" path="answer_segment_hdr_t[].answer_segment_hdr_t.transaction_type[].transaction_type_t.server_type_c" value="A" fieldType="Char"/>
        <testCommand xsi:type="TestUnit:CreateFieldValueCheckCommand" disabled="true" path="answer_segment_hdr_t[].answer_segment_hdr_t.transaction_type[].transaction_type_t.transaction_number_n" value="124" fieldType="BigDecimal"/>
        <messageType>DA124</messageType>
      </testCommand>
      <testCommand xsi:type="TestUnit:NewVar" variableId="Segment_No" value="%MESSAGES.DA124.answer_segment_hdr_t[].answer_segment_hdr_t.segment_number_n%"/>
      <testCommand xsi:type="TestUnit:NewVar" variableId="DQ124_DL_Ref_No" value="%MESSAGES.DA124.ns_delta_header_t[].ns_delta_header_t.download_ref_number_q%"/>
      <testCommand xsi:type="TestUnit:WhileLoopCommand" disabled="true" logicStatement="eval(&quot;%VARIABLES.Segment_No%!=0&quot;)" maxIterationSafety="">
        <testCommand xsi:type="TestUnit:WaitCommand" disabled="true" messageSenderProducer="//@test/@testCommand.0" messageCount="1" timeout="-1" searchFromLastMatch="true" searchFromLastMatchCombined="true" removeMatched="true">
          <testCommand xsi:type="TestUnit:CreateFieldValueCheckCommand" disabled="true" path="query_delta_t[].query_delta_t.transaction_type[].transaction_type_t.central_module_c" value="D" fieldType="Char"/>
          <testCommand xsi:type="TestUnit:CreateFieldValueCheckCommand" disabled="true" path="query_delta_t[].query_delta_t.transaction_type[].transaction_type_t.server_type_c" value="Q" fieldType="Char"/>
          <testCommand xsi:type="TestUnit:CreateFieldValueCheckCommand" disabled="true" path="query_delta_t[].query_delta_t.transaction_type[].transaction_type_t.transaction_number_n" value="124" fieldType="BigDecimal"/>
          <testCommand xsi:type="TestUnit:CreateFieldValueCheckCommand" disabled="true" path="query_delta_t[].query_delta_t.segment_number_n" value="eval(&quot;%VARIABLES.Segment_No%+1&quot;)" fieldType="BigDecimal"/>
          <testCommand xsi:type="TestUnit:CreateFieldValueCheckCommand" disabled="true" path="query_delta_t[].query_delta_t.series[].series_t.market_c" value="0 || %CONFIGURATIONS.Series_Market%" fieldType="BigDecimal"/>
          <messageType>DQ124</messageType>
        </testCommand>
        <testCommand xsi:type="TestUnit:WaitCommand" disabled="true" messageId="DA124" messageSenderProducer="//@test/@testCommand.0" messageCount="1" timeout="-1" searchFromLastMatch="true" searchFromLastMatchCombined="true" outgoingMessage="true" removeMatched="true">
          <testCommand xsi:type="TestUnit:CreateFieldValueCheckCommand" disabled="true" path="answer_segment_hdr_t[].answer_segment_hdr_t.transaction_type[].transaction_type_t.central_module_c" value="D" fieldType="Char"/>
          <testCommand xsi:type="TestUnit:CreateFieldValueCheckCommand" disabled="true" path="answer_segment_hdr_t[].answer_segment_hdr_t.transaction_type[].transaction_type_t.server_type_c" value="A" fieldType="Char"/>
          <testCommand xsi:type="TestUnit:CreateFieldValueCheckCommand" disabled="true" path="answer_segment_hdr_t[].answer_segment_hdr_t.transaction_type[].transaction_type_t.transaction_number_n" value="124" fieldType="BigDecimal"/>
          <messageType>DA124</messageType>
        </testCommand>
        <testCommand xsi:type="TestUnit:NewVar" disabled="true" variableId="Segment_No" value="%MESSAGES.DA124.answer_segment_hdr_t[].answer_segment_hdr_t.segment_number_n%"/>
        <testCommand xsi:type="TestUnit:NewVar" disabled="true" variableId="DQ124_DL_Ref_No" value="%MESSAGES.DA124.ns_delta_header_t[].ns_delta_header_t.download_ref_number_q%"/>
      </testCommand>
      <testCommand xsi:type="TestUnit:GetInteractiveFeedbackCommand" variableId="Response" requireUserInput="true">
        <instructionMultiLanguage key="en" value="Did you receive DA124 answer(s) with all tradable instrument series in all markets?&#xD;&#xA;(Enter y for yes, n for no)"/>
      </testCommand>
      <testCommand xsi:type="TestUnit:IfStatementCommand">
        <testCommand xsi:type="TestUnit:IfThenElseStatementBlock" logicStatement="eval(&quot;! equalsIgnoreCase(&quot;%VARIABLES.Response%&quot;, &quot;y&quot;) &amp;&amp; ! equalsIgnoreCase(&quot;%VARIABLES.Response%&quot;, &quot;yes&quot;)&quot;)">
          <testCommand xsi:type="TestUnit:FailCommand" text="You should have received DA124 answer(s) with all tradable instrument series in all markets."/>
        </testCommand>
      </testCommand>
      <testCommand xsi:type="TestUnit:CreateGlobalVariable" variableId="DeltaSeriesTestStatus" value="Y"/>
      <testCommand xsi:type="TestUnit:ExportGlobalVariables" filePath="DeltaTestCompletionStatus.gbl">
        <variableId>DeltaSeriesTestStatus</variableId>
      </testCommand>
    </testCommand>
  </test>
</TestUnit:TestContainerType>
